# Информация о проекте iikoServiceHelper

## Общее описание

iikoServiceHelper - это приложение для автоматизации ответов с графическим интерфейсом и системным треем, переписанное на .NET 6 (WPF). Оно предоставляет различные инструменты и функции для упрощения работы службы поддержки iiko.

## Основные компоненты

*   **MainWindow.xaml.cs**: Основной файл окна приложения, содержащий логику UI, обработку событий и интеграцию с другими сервисами.
*   **CommandExecutionService.cs**: Сервис для последовательного выполнения команд и макросов, добавляемых в очередь.
*   **HotkeyManager.cs**: Класс, отвечающий за перехват и обработку глобальных горячих клавиш.
*   **DefaultCommandsProvider.cs**: Предоставляет список стандартных команд, используемых в приложении.
*   **BrowserFinder.cs**: Класс для поиска установленных браузеров в системе.
*   **AppSettings.cs**: Модель для хранения настроек приложения, таких как размер шрифта заметок, учетные данные CRM, выбранный браузер и т.д.
*   **ThemeSettings.cs**: Модель для хранения настроек темы приложения (цвета для светлой и темной тем).

## Ключевые функции

*   **GUI (WPF)**: Светлая и темная темы, настраиваемые цвета.
*   **Системный трей**: Сворачивание в трей, управление приложением из трея.
*   **Горячие клавиши**: Перехват глобальных горячих клавиш для быстрого выполнения команд.
*   **Макросы**: Автоматизация ввода текста и команд.
*   **Alt Blocker**: Блокировка клавиши Alt для предотвращения потери фокуса в браузерах.
*   **CRM Авто-вход**: Автоматическая авторизация в CRM (Chrome, Edge, Yandex).
*   **Заметки**: Встроенный блокнот с автосохранением и масштабированием.

## Конфигурация

*   Настройки приложения хранятся в `%LOCALAPPDATA%\iikoServiceHelper\settings.json`.
*   Заметки сохраняются в `%LOCALAPPDATA%\iikoServiceHelper\notes.txt`.
*   Настройки темы хранятся в `%LOCALAPPDATA%\iikoServiceHelper\theme_colors.json`.
*   Подробные логи записываются в `%LOCALAPPDATA%\iikoServiceHelper\detailed_log.txt`.

## Зависимости

*   .NET SDK 8.0
*   WPF
*   Windows Forms (для работы с системным треем и горячими клавишами)
*   `Microsoft.Extensions.DependencyInjection`
*   `Microsoft.Extensions.Logging`
*   `System.Security.Cryptography.ProtectedData`

## Процесс сборки

1.  Установите расширение **C# Dev Kit** в VS Code.
2.  Нажмите `F5` для запуска отладки.

### Команды для сборки

*   **Portable (Автономная)**

    ```powershell
    dotnet publish iikoServiceHelper.csproj -c Release -p:EnableCompressionInSingleFile=true
    ```
*   **Compact (Компактная)**

    ```powershell
    dotnet publish iikoServiceHelper.csproj -c Release -p:SelfContained=false
    ```

## Дополнительная информация

*   Для авто-входа в CRM необходимо запускать браузер с параметром `--remote-debugging-port=9222`.
*   Приложение использует библиотеку `System.Windows.Forms` для работы с системным треем и глобальными горячими клавишами.
*   Для работы с буфером обмена в Windows 10/11 используется WinRT API.

